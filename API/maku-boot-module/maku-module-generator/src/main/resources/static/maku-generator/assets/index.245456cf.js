import{d as h,r as y,a as L,b as n,o as S,c as V,w as t,e,l as k,h as _,v as U,x as R,E as $,k as z,u as c,m as O,i as H,y as M}from"./index.7fff850b.js";import{b as P,c as j,d as K}from"./datasource.baea765c.js";import{u as G}from"./index.e5831a10.js";const I=_("\u53D6\u6D88"),J=_("\u786E\u5B9A"),W=h({__name:"add-or-update",emits:["refreshDataList"],setup(N,{expose:r,emit:C}){const m=y(!1),f=y(),u=L({id:"",dbType:"",connName:"",connUrl:"",username:"",password:""}),D=i=>{m.value=!0,u.id="",f.value&&f.value.resetFields(),i&&E(i)},E=i=>{P(i).then(l=>{l.data.password=U(l.data.password),Object.assign(u,l.data)})},F=y({dbType:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connName:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],connUrl:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],username:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5FC5\u586B\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=()=>{f.value.validate(i=>{if(!i)return!1;j({...u,password:R(u.password)}).then(()=>{$.success({message:"\u64CD\u4F5C\u6210\u529F",duration:500,onClose:()=>{m.value=!1,C("refreshDataList")}})})})};return r({init:D}),(i,l)=>{const o=n("el-input"),g=n("el-form-item"),d=n("el-option"),b=n("el-select"),B=n("el-form"),p=n("el-button"),w=n("el-dialog");return S(),V(w,{modelValue:m.value,"onUpdate:modelValue":l[8]||(l[8]=a=>m.value=a),title:u.id?"\u4FEE\u6539":"\u65B0\u589E","close-on-click-modal":!1},{footer:t(()=>[e(p,{onClick:l[6]||(l[6]=a=>m.value=!1)},{default:t(()=>[I]),_:1}),e(p,{type:"primary",onClick:l[7]||(l[7]=a=>v())},{default:t(()=>[J]),_:1})]),default:t(()=>[e(B,{ref_key:"dataFormRef",ref:f,model:u,rules:F.value,"label-width":"120px",onKeyup:l[5]||(l[5]=k(a=>v(),["enter"]))},{default:t(()=>[e(g,{label:"\u8FDE\u63A5\u540D",prop:"connName"},{default:t(()=>[e(o,{modelValue:u.connName,"onUpdate:modelValue":l[0]||(l[0]=a=>u.connName=a),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(g,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(b,{modelValue:u.dbType,"onUpdate:modelValue":l[1]||(l[1]=a=>u.dbType=a),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B",style:{width:"100%"}},{default:t(()=>[e(d,{value:"MySQL",label:"MySQL"}),e(d,{value:"Oracle",label:"Oracle"}),e(d,{value:"PostgreSQL",label:"PostgreSQL"}),e(d,{value:"SQLServer",label:"SQLServer"}),e(d,{value:"DM",label:"\u8FBE\u68A68"}),e(d,{value:"Clickhouse",label:"Clickhouse"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"\u6570\u636E\u5E93URL",prop:"connUrl"},{default:t(()=>[e(o,{modelValue:u.connUrl,"onUpdate:modelValue":l[2]||(l[2]=a=>u.connUrl=a),placeholder:"\u6570\u636E\u5E93URL"},null,8,["modelValue"])]),_:1}),e(g,{label:"\u7528\u6237\u540D",prop:"username"},{default:t(()=>[e(o,{modelValue:u.username,"onUpdate:modelValue":l[3]||(l[3]=a=>u.username=a),placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),e(g,{label:"\u5BC6\u7801",prop:"password"},{default:t(()=>[e(o,{modelValue:u.password,"onUpdate:modelValue":l[4]||(l[4]=a=>u.password=a),autocomplete:"off",type:"password",placeholder:"\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),X=_("\u67E5\u8BE2"),Y=_("\u65B0\u589E"),Z=_("\u5220\u9664"),ee=_("\u6D4B\u8BD5"),le=_("\u7F16\u8F91"),te=_("\u5220\u9664"),ne=h({__name:"index",setup(N){const r=L({dataListUrl:"/gen/datasource/page",deleteUrl:"/gen/datasource",queryForm:{connName:"",dbType:""}}),C=l=>{K(l).then(o=>{$.success(o.data)})},m=y(),f=l=>{m.value.init(l)},{getDataList:u,selectionChangeHandle:D,sizeChangeHandle:E,currentChangeHandle:F,deleteBatchHandle:v}=G(r),i=l=>Array(U(l).length).fill("\u2022").join("");return(l,o)=>{const g=n("el-input"),d=n("el-form-item"),b=n("el-option"),B=n("el-select"),p=n("el-button"),w=n("el-form"),a=n("el-table-column"),Q=n("el-table"),T=n("el-pagination"),q=n("el-card"),x=z("loading");return S(),V(q,null,{default:t(()=>[e(w,{inline:!0,model:r.queryForm,onKeyup:o[5]||(o[5]=k(s=>c(u)(),["enter"]))},{default:t(()=>[e(d,null,{default:t(()=>[e(g,{modelValue:r.queryForm.connName,"onUpdate:modelValue":o[0]||(o[0]=s=>r.queryForm.connName=s),placeholder:"\u8FDE\u63A5\u540D"},null,8,["modelValue"])]),_:1}),e(d,{prop:"dbType"},{default:t(()=>[e(B,{modelValue:r.queryForm.dbType,"onUpdate:modelValue":o[1]||(o[1]=s=>r.queryForm.dbType=s),clearable:"",placeholder:"\u6570\u636E\u5E93\u7C7B\u578B"},{default:t(()=>[e(b,{value:"MySQL",label:"MySQL"}),e(b,{value:"Oracle",label:"Oracle"}),e(b,{value:"PostgreSQL",label:"PostgreSQL"}),e(b,{value:"SQLServer",label:"SQLServer"}),e(b,{value:"DM",label:"\u8FBE\u68A68"})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(p,{onClick:o[2]||(o[2]=s=>c(u)())},{default:t(()=>[X]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(p,{type:"primary",onClick:o[3]||(o[3]=s=>f())},{default:t(()=>[Y]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(p,{type:"danger",onClick:o[4]||(o[4]=s=>c(v)())},{default:t(()=>[Z]),_:1})]),_:1})]),_:1},8,["model"]),O((S(),V(Q,{data:r.dataList,border:"",style:{width:"100%"},onSelectionChange:c(D)},{default:t(()=>[e(a,{type:"selection","header-align":"center",align:"center",width:"50"}),e(a,{prop:"connName",label:"\u8FDE\u63A5\u540D","header-align":"center",align:"center"}),e(a,{prop:"dbType",label:"\u6570\u636E\u5E93\u7C7B\u578B","header-align":"center",align:"center"}),e(a,{prop:"connUrl",label:"\u6570\u636E\u5E93URL","show-overflow-tooltip":"","header-align":"center",align:"center"}),e(a,{prop:"username",label:"\u7528\u6237\u540D","header-align":"center",align:"center"}),e(a,{label:"\u5BC6\u7801","header-align":"center",align:"center"},{default:t(s=>[H("span",null,M(i(s.row.password)),1)]),_:1}),e(a,{label:"\u64CD\u4F5C",fixed:"right","header-align":"center",align:"center",width:"170"},{default:t(s=>[e(p,{type:"primary",link:"",onClick:A=>C(s.row.id)},{default:t(()=>[ee]),_:2},1032,["onClick"]),e(p,{type:"primary",link:"",onClick:A=>f(s.row.id)},{default:t(()=>[le]),_:2},1032,["onClick"]),e(p,{type:"primary",link:"",onClick:A=>c(v)(s.row.id)},{default:t(()=>[te]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[x,r.dataListLoading]]),e(T,{"current-page":r.page,"page-sizes":r.pageSizes,"page-size":r.limit,total:r.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c(E),onCurrentChange:c(F)},null,8,["current-page","page-sizes","page-size","total","onSizeChange","onCurrentChange"]),e(W,{ref_key:"addOrUpdateRef",ref:m,onRefreshDataList:c(u)},null,8,["onRefreshDataList"])]),_:1})}}});export{ne as default};
